# FastSLAM 2.0
This is a Python implementation of FastSLAM 2.0 for the [JdeRobot Robotics Academy "MonteCarlo laser-based robot localization"](https://jderobot.github.io/RoboticsAcademy/exercises/MobileRobots/montecarlo_laser_loc/) practice.

This project includes a Dockerfile that builds the `jderobot/robotics-backend` Docker image, which provides the simulation environment for the practice.
The Dockerfile copies the FastSLAM 2.0 implementation as a package into the `/workspace/code` folder within the Docker image,
making it available for use in the practice.

## Startup
To start the simulation environment and run the FastSLAM 2.0 implementation, 
you need to create a Docker container using the provided Dockerfile.
A bash script named `startup.sh` is located in the root directory of this repository and
will automatically build the Docker image by performing the following steps:
1. Install the necessary Python packages on your local system for the map module.
2. Create a shared folder on your local device to exchange files between your local system and the Docker container.
   - To change the shared folder, update the paths in both `landmark_map/main.py` and `startup.py`. Ensure that the paths match. The default shared folder path is `C:/shared`.
3. Build the `jderobot/robotics-backend` Docker image. 
4. Copy the FastSLAM 2.0 package to the Docker image. 
5. Install the required Python packages inside the Docker container. 
6. Run the Docker container with the shared folder mounted.

To run the `startup.sh`, ensure that Docker Desktop is running, then execute the following command in a **bash** terminal:
```bash
bash startup.sh
```
After running the bash script, the simulation environment will start.
You can access the simulation user interface by opening a web browser and navigating to http://localhost:7164/.

The landmark maps will be generated by the `landmark_map` module.
To plot the landmark maps produced by the FastSLAM 2.0 module, run the following command in a bash terminal:
```bash
python landmark_map/main.py
```

## Project structure
The generation of landmark maps (`landmark_map` module) and the FastSLAM 2.0 implementation (`fast_slam_2` module)
are separated from each other. The FastSLAM 2.0 implementation is copied and executed as a package in the Docker container.
During this process, JSON files are generated and stored in the shared folder.
These files contain all the necessary information to generate the landmark maps.

The `landmark_map` module can access these JSON files via the shared folder to create the maps.
It is therefore important that the paths for the shared folder are correctly set in `landmark_map/main.py` and `startup.sh`.
This separation offloads the map generation process from the robot,
keeping the computational load of the FastSLAM 2.0 implementation low.
This ensures performance and thus also the accuracy of localization.

### FastSLAM 2.0
The FastSLAM 2.0 implementation is located in the `fast_slam_2` module.
It consists of model, utility, and algorithm classes, along with a configuration file, which will be explained in the following sections.

Additionally, there is a `jde_robots_main.py` file in the root directory of this repository.
This file contains the Python script that needs to be uploaded into the simulation environment to run the FastSLAM 2.0 implementation.
It imports the necessary classes from the `fast_slam_2` module, initializes the FastSLAM 2.0 algorithm, and
manages the while loop that controls both the robot's movement and the FastSLAM 2.0 algorithm.

#### Configuration
You can configure the FastSLAM 2.0 algorithm by modifying the `config.py` file located in the `fast_slam_2` module.
The `config.py` file contains parameters which can be adjusted to adjust the FastSLAM 2.0 algorithm:
- `NUM_PARTICLES`: The number of particles used in the particle filter.
- `TRANSLATION_NOISE`: A factor that determines the noise in the robot's translation movement.
- `ROTATION_NOISE`: A factor that determines the noise in the robot's rotation movement.
- `MEASUREMENT_NOISE`: A covariance matrix that determines the noise in the measurements.
- `MAXIMUM_LANDMARK_DISTANCE`: The maximum distance between to landmarks to be considered as the same landmark (mahalanobis distance).
- `NUM_THREADS`: The number of threads used for parallel processing.

#### Model classes
The `fast_slam_2/models` folder contains the model classes used in the FastSLAM 2.0 implementation:
- `Point`: Represents a point in the environment.
- `DirectedPoint`: Represents a point with a direction in the environment.
- `Measurement`: Represents a measurement including the distance and angle to a landmark.
- `Landmark`: Represents a landmark in the environment. Extends the `Point` class.
- `Particle`: Represents a particle in the particle filter. Extends the `DirectedPoint` class.
- `Robot`: Represents the robot's state and provides methods to update the robot's state. Extends the `DirectedPoint` class.
- `EvaluationResult`: Represents the evaluation result of the FastSLAM 2.0 algorithm.

#### Utils classes
The `fast_slam_2/utils` folder contains utility classes used in the FastSLAM 2.0 implementation:
- `GeometryUtils`: Provides methods to calculate geometric properties (e.g. mahalanobis distance, clustering, ...).
- `LandmarkUtils`: P